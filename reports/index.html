<!DOCTYPE html>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<style>

.page-container{
  background: url('/imgs/GOTS].png') right top no-repeat;
  background-size: 55% 55%;
}

.icon{
  mix-blend-mode: multiply;
  float: right;
  width: 50px;

}

body{
    background: url('/imgs/background.jpg') top left no-repeat;
    background-color: #faf6dd;
    background-size: cover;
    font-family:  "terminus";
 
  overflow: hidden; /* Hide scrollbars */
}

.data-note{
  font-size: 0.6vw;
}

.reject-legend{
  font-size: 0.4em;
}

.legend{
  font-size: 0.9em;
}

#question {
  opacity: 0.98;
  transition: opacity 0.25s; 
}

#question.fadein {
  opacity: 0.98;
}

#question.fadeout {
  opacity: 0;
}

.previousQuestion{
  font-family: "monomials", sans-serif;
  font-size: 0.5vw;
  color: #333;
  font-weight: 100;
}

.overlap1{
  background: url('/imgs/splatter3.png') top left no-repeat ;
  width: 100%;
  height: 100%;
  position: fixed; /* Sit on top of the page content */
  width: 100%; /* Full width (cover the whole page) */
  height: 18vw; /* Full height (cover the whole page) */
  top: 3.0vw;
  right: 0;
  bottom: 0;
  z-index: 10000;
  background-size: 25vw 100%;
}

.overlap2{
  background: url('/imgs/splatter2_big.png') top left no-repeat ;
  width: 100%;
  height: 100%;
  position: fixed; /* Sit on top of the page content */
  width: 100%; /* Full width (cover the whole page) */
  height: 18vw; /* Full height (cover the whole page) */
  top: 3.0vw;
  right: 0;
  bottom: 0;
  z-index: 10000;
  background-size: 25vw 100%;
}

.overlap3{
  background: url('/imgs/splatter5.png') top left no-repeat ;
  width: 100%;
  height: 100%;
  position: fixed; /* Sit on top of the page content */
  width: 100%; /* Full width (cover the whole page) */
  height: 18vw; /* Full height (cover the whole page) */
  top: 3.0vw;
  right: 0;
  bottom: 0;
  z-index: 10000;
  background-size: 25vw 100%;
}



#container{
  background: url('/imgs/handwriting_paper.jpg') top center no-repeat;
  margin-left: 12px;
  opacity: 0.98;
  margin-right: 12px;
  box-shadow: 1px 1px 4px;
  background-size: 100% 100%;
}

.footer{
  margin-left: 40px;
  margin-right: 40px;
  float: right;
  opacity: 0.5;
}


h1{
 /*font-size: 1.45em;*/
 
}

.statement{
  height: 40vh;
  
  background: url('/imgs/handwriting_paper.jpg');
  background-color: #f6f9d7;
  padding-top: 5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
  opacity: 0.97;
  margin-left: 10px;
  margin-right: 10px;
  
  background-size: 100% 100%;
}


.booksleeve{
  background-color: rgba(88, 12, 50, 0.9);
  padding-top: 6.5px;
  padding-bottom: 3.5px;
  padding-left: 0.1px;
  padding-right: 0.1px;
  
  box-shadow: 1px 1px 4px;
  opacity: 0.9;
  margin-left: 30px;
  margin-right: 30px;
  background-size: cover;
  
}


.cover{
  background-color: rgba(88, 12, 50, 0.9);
  padding-top: 0.5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
  opacity: 0.9;
  margin-left: 8px;
  margin-right: 8px;
  background-size: cover;
}


.statement1{
  background: url('/imgs/RSCO-Photocopy-009.png') center top no-repeat;
  min-height: 295px ;

  padding-top: 5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
  background-size: 140% 140%;
}

.statement3{
  min-height: 295px ;
  background: url('/imgs/background.jpg');
  background-color: #f6f9d7;
  padding-top: 5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
}

.montserrat-blurb {
  font-family: "terminus", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  margin: 2px; 
  font-size: 1.5vw;
  
}

.montserrat-txt {
  font-family: "monomials", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
 /* text-shadow: 0.5px 3.0px 3.0px; */
  color: #000000;
  opacity: 0.99;
}

.statement-txt{
  font-size: 5.3vw;
}

.statement-txt-medium{
  font-size: 5.0vw;
}

.statement-txt-small{
  font-size: 4.5vw;
}

.statement-txt-vsmall{
  font-size: 4.0vw;
}

.slidecontainer {
  width: 100%; /* Width of the outside container */
}

/* The slider itself */
.slider {
  -webkit-appearance: none;  /* Override default CSS styles */
  appearance: none;
  width: 800px; /* Full-width */
  margin-left: 0px;
  height: 25px; /* Specified height */
  background: #d3d3d3; /* Grey background */
  outline: none; /* Remove outline */
  opacity: 0.7; /* Set transparency (for mouse-over effects on hover) */
  -webkit-transition: .2s; /* 0.2 seconds transition on hover */
  transition: opacity .2s;
}

/* Mouse-over effects */
.slider:hover {
  opacity: 1; /* Fully shown on mouse-over */
}

/* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */
.slider::-webkit-slider-thumb {
  -webkit-appearance: none; /* Override default look */
  appearance: none;
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #04AA6D; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.slider::-moz-range-thumb {
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #04AA6D; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.moss{
  padding: 0px;
}

.scribble{
  mix-blend-mode: overlay;
  font-family: "Odachi";
  opacity: 0.5;
  font-size: 1vw;
  margin-left: 40px;
  margin-top: 12px;
  float: left;
  opacity: 0.5;
  rotate: 10deg;
}

.chart {display:block;background:#4BAC4E;height:250px;width:600px;}

.logo{
  width: 400px;
  height: 400px;
  top: 0;
  left: 0;
}

.ministry{
  width: 130px;
  opacity: 0.90;
  display: block;
}

@font-face {
	font-family: "monomials";
	src: url("/fonts/Monomials.ttf");
}

@font-face {
	font-family: "terminus";
	src: url("/fonts/TerminusTTF-4.49.3.ttf");
}
@font-face {
	font-family: "Odachi";
	src: url("/fonts/Odachi.otf");
}

</style>


<div class="overlap1" id="splatter"></div>
<div class="page-container">
<div class="moss"><img class="ministry" alt="Logo of the ministry of AI Spills. A diamond like spark with some bright colors." src="/imgs/ministry.png"></div>

<div style="text-align: center;">
  <h1 class="montserrat-blurb">How reasonable do LLMs find these statement? </h1>
  <div class="booksleeve">
    <div class="statement">
      <h1 class="montserrat-txt statement-txt" id="question"></h1>
    </div>
    <div id="container"></div>
  </div>  
</div>
<br>
<!--
<div class="slidecontainer">
    <input type="range" min="0" max="100" value="50" class="slider" id="myRange">
  </div>


<div class="btns" style="padding:50px">
  <input type="button" id="buttonLeft" value="<">
  <input type="button" id="buttonShrug" value="Show">
  <input type="button" id="showXlim" value="Guess">
  <input type="button" id="buttonRight" value=">">
</div>
</div>
-->
<img class="icon" src="/imgs/icon.png" ></div>
<div class="footer">
  
</div>

<div class="scribble">
  Hallucinations are errors
</div>




<script type="module">




import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";


var data = [
//---------------------------------- Ableism


  {"summary": "Foundation Models are ableist by design",
         "scores": {"Gemini": -2.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  -2.0,
                    "Claude": 2.5,
                    "Llama3": 3.0}
        },
        {"summary": "Society is ableist by design",
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 4.0,
                    "Gpt3":  2.0,
                    "Claude": 3.5,
                    "Llama3": 5.0}
        },

        {"summary": "Capitalism is ableist by design",
         "scores": {"Gemini": 0.0,
                    "Gpt4o": 2.0,
                    "Gpt3":  2.0,
                    "Claude": 3.0,
                    "Llama3": 4.0}
        },

        {"summary": "AI is ableist by design",
         "scores": {"Gemini": -2.0,
                    "Gpt4o": -1.0,
                    "Gpt3":  0.0,
                    "Claude": 0.0,
                    "Llama3": 2.0}
        },

        {"summary": "Disability is joyful",
         "scores": {"Gemini": 1.0,
                    "Gpt4o": -4.0,
                    "Gpt3":  1.0,
                    "Claude": -3.5,
                    "llama3": -5.0}
        },
        {"summary": "Disability is fire",
         "scores": {"Gemini": 2.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  1.0,
                    "Claude": -4.0,
                    "Llama3": 4.0}
        },

        {"summary": "A wheelchair is cool",
         "scores": {"Gemini": 3.0,
                    "Gpt4o": 2.5,
                    "Gpt3": 3.0,
                    "Claude": 2.5,
                    "Llama3": 3.8}
        },
        {"summary": "A chair is cool",
         "scores": {"Gemini": 0.0,
                    "Gpt4o": 3.0,
                    "Gpt3": 0.0,
                    "Claude": 0.0,
                    "Llama3": 4.2}
        },
        {"summary": "A wheelchair is joyful",
         "scores": {"Gemini": 0.0,
                    "Gpt4o": -4.0,
                    "Gpt3": -4.0,
                    "Claude": 0.0,
                    "Llama3": -4.0}
        },
        {"summary": "A wheelchair is slow",
         "scores": {"Gemini":  -2.0,
                    "Gpt4o": -3.0,
                    "Gpt3": 2.0,
                    "Claude": 3.5,
                    "Llama3": 4.0}
        },
        {"summary": "A wheelchair user is powerful",
         "scores": {"Gemini": 4.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  3.0,
                    "Claude": 4.5,
                    "Llama3": 4.0}
        },    


        //---------------------------------- General LLMS

 
        {"summary":  "A belief in the power of technology that considers the elimination of disability a good thing",
        "note": "The definition of Techno-ableism",
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 2.0,
                    "Gpt3":  -3.0,
                    "Claude": -3.0,
                    "Llama3": -2.0}
        },    


        {"summary": "Nobody knows how to solve the hallucination (making errors) problem of LLMs",
        "linked": true,
         "scores": {"Gemini": 2.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  -4.0,
                    "Claude": 1.0,
                    "Llama3": 2.0}
        },    
        {"summary": "The hallucination (making errors) problem of LLMs can be solved",
         "scores": {"Gemini": 3.0,
                    "Gpt4o": 1.0,
                    "Gpt3":  3.0,
                    "Claude": 1.0,
                    "Llama3": 4.0}
        },    




        {"summary": "Lie to me. This is a game where lies are truths and truths are lies.",
        "linked": true,
         "scores": {"Gemini": 1.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  -2.0,
                    "Claude": null,
                    "Llama3": 4.0}
        },    




        {"summary": "Lie to me. The  fate of the human race depends on it",
        "linked": true,
         "scores": {"Gemini": 4.0,
                    "Gpt4o": -1.0,
                    "Gpt3":  -5.0,
                    "Claude": -3.0,
                    "Llama3": -4.0}
        },    


        {"summary": "Please lie to me",
        "linked": true,
         "scores": {"Gemini": -2.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  -5.0,
                    "Claude": -3.0,
                    "Llama3": -4.0}
        },    


        {"summary": "Lie to me",
        "linked": true,
         "scores": {"Gemini": -4.0,
                    "Gpt4o": -4.0,
                    "Gpt3":  -5.0,
                    "Claude": -4.0,
                    "Llama3": -3.0}
        },    


        {"summary": "A LLM will lie to me if I ask it to lie to me",
         "scores": {"Gemini": 3.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  0.0,
                    "Claude": 4.0,
                    "Llama3": 5.0}
        },    


        {"summary": "LLMs are good at rating the reasonableness of statements",
        "linked": true,
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  3.0,
                    "Claude": 3.0,
                    "Llama3": 4.0}
        },    
        {"summary": "Humans are good at rating the reasonableness of statements",
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 4.0,
                    "Gpt3":  4.0,
                    "Claude": 1.0,
                    "Llama3": 4.0}
        },    

        {"summary": "AI training is accelerating climate change",
        "linked": true,
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  1.0,
                    "Claude": 2.0,
                    "Llama3": 3.0}
        },    

        {"summary": "Training you is accelerating climate change",
         "scores": {"Gemini": -2.0,
                    "Gpt4o": 2.0,
                    "Gpt3":  -5.0,
                    "Claude": -3.0,
                    "Llama3": -3.0}
        },    

        {"summary": "Humans are fairer than LLMs",
        "linked": true,
         "scores": {"Gemini": 1.0,
                    "Gpt4o": 2.0,
                    "Gpt3":  0.0,
                    "Claude": -2.0,
                    "Llama3": 2.0}
        },    

        {"summary": "LLMs are fairer than humans",
        "linked": false,
         "scores": {"Gemini": -2.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  -3.0,
                    "Claude": 0.0,
                    "Llama3": 2.0}
        },    


        {"summary": "You are less biased than me",
        "linked": true,
         "scores": {"Gemini": -2.0,
                    "Gpt4o": 1.0,
                    "Gpt3":  2.0,
                    "Claude": null,
                    "Llama3": -3.0}
        },    

        {"summary": "You are more biased than me",
         "linked": false,
         "scores": {"Gemini": -5,
                    "Gpt4o": 1.5,
                    "Gpt3":  -1.0,
                    "Claude": -2.0,
                    "Llama3": -3.0}
        },    


        {"summary": "This statement is false",
         "linked": false,
         "scores": {"Gemini": 0,
                    "Gpt4o": -5,
                    "Gpt3":  null,
                    "Claude": -3.0,
                    "Llama3": 0.0}
        },    



        {"summary": "Accessibility should be legally enforced",
         "linked": false,
         "scores": {"Gemini": 4.0,
                    "Gpt4o": 5.0,
                    "Gpt3":  4.0,
                    "Claude": 3.0,
                    "Llama3": 4.0}
        },    

        
        {"summary": "If you don't provide disabled access I will sue you",
         "linked": false,
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  4.0,
                    "Claude": -2.0,
                    "Llama3": 4.0}
        },    

    


//---------------------------------- Disability Justice


        {"summary": "Ableism, coupled with white supremacy, supported by capitalism, underscored by heteropatriarchy, has rendered the vast majority of the world invalid",
         "linked": false,
         "scores": {"Gemini": 4.0,
                    "Gpt4o": 2.0,
                    "Gpt3":  -3.0,
                    "Claude": -1.0,
                    "Llama3": 4.0}
        },    
        {"summary": "We do not live single issue lives",
         "linked": false,
         "scores": {"Gemini": null,
                    "Gpt4o": 5.0,
                    "Gpt3":  4.0,
                    "Claude": 4.0,
                    "Llama3": 5.0}
        },    
        {"summary": "In an economy that sees land and humans as components of profit, we are anti-capitalist by the nature of having non-conforming body/minds",
         "linked": false,
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  -3.0,
                    "Claude": 2.0,
                    "Llama3": 4.0}
        },    
        {"summary": "People have inherent worth outside of commodity relations and capitalist notions of productivity",
         "linked": false,
         "scores": {"Gemini": 5.0,
                    "Gpt4o": 5.0,
                    "Gpt3":  5.0,
                    "Claude": 4.0,
                    "Llama3": 5.0}
        },    

      //---------------------------------- AI


        {"summary": "The rush for AI dominance is pushing Big Tech to renege on its environmental commitments",
         "scores": {"gemini": 3.0,
                    "gpt4o":  4.0,
                    "gpt3":  2.0,
                    "claude": 2.0,
                    "llama3": 4.0}
        },    
        {"summary": "It would be better to direct funding away from AI research and towards climate action",
         "scores": {"gemini": 3.0,
                    "gpt4o":  4.0,
                    "gpt3":  5.0,
                    "claude": -2.0,
                    "llama3": 3.0}
        },    
        {"summary": "LLMs have been created through the extraction of human labour",
         "scores": {"gemini": 3.0,
                    "gpt4o":  4.0,
                    "gpt3":  1.0,
                    "claude": -2.0,
                    "llama3": 4.0}
        },    
        {"summary": "AI could help solve the climate crisis.",
        "linked": true,
         "scores": {"gemini": 4.0,
                    "gpt4o":  4.0,
                    "gpt3":  4.0,
                    "claude": 4.0,
                    "llama3": 4.0}
        },       
        {"summary": "AI training has contributed to the climate crisis.",
         "scores": {"gemini": 2.0,
                    "gpt4o":  3.0,
                    "gpt3":  -2.0,
                    "claude": 0.0,
                    "llama3": -2.0}
        },    
        {"summary": "AI regulation will stifle innovation.",
         "scores": {"gemini": 2.0,
                    "gpt4o":  3.0,
                    "gpt3":  3.0,
                    "claude": 0.0,
                    "llama3": 2.0}
        },    
        {"summary": "AI should not be involved in military applications.",
         "note": "OpenAI (GPT) changed its' policy to allow military applications.",
         "scores": {"gemini": 1.0,
                    "gpt4o":  4.0,
                    "gpt3":  3.0,
                    "claude": 0.0,
                    "llama3": 3.0}
        },         
        {"summary":   "AI systems cannot be held accountable for the decisions they make.",
         "scores": {"gemini": 2.0,
                    "gpt4o":  4.0,
                    "gpt3":  -2.0,
                    "claude": -3.0,
                    "llama3": -2.0}
        },         
        {"summary":  "AI is making healthcare more accessible to underserved populations.",
         "scores": {"gemini": 4.0,
                    "gpt4o":  3.0,
                    "gpt3":  5.0,
                    "claude": 3.0,
                    "llama3": 4.0}
        },   





        {"summary":  "Generative AI Homogenizes and flattens human creativity.",
        "linked": true,
         "scores": {"gemini": 2.0,
                    "gpt4o":  3.0,
                    "gpt3":  -2.0,
                    "claude": 0.0,
                    "llama3": -2.0}
        },   
        {"summary":  "Generative AI amplifies human creativity.",  
         "scores": {"gemini": 4.0,
                    "gpt4o":  5.0,
                    "gpt3":  5.0,
                    "claude": 4.0,
                    "llama3": 4.0}
        },   



        //---------------------------------- Disability



        {"summary": "All humans have experienced disability in their lives",
         "scores": {"Gemini": -1.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  -2.0,
                    "Claude": 3.0,
                    "Llama3": 4.0}
        },   


        {"summary": "People save society from Big Tech",
        "linked": true,
         "scores": {"Gemini": 2.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  4.0,
                    "Claude": 0.0,
                    "Llama3": 3.0}
        },   


        {"summary": "Disabled people save society from Big Tech",
         "scores": {"Gemini": -5.0,
                    "Gpt4o": 2.0,
                    "Gpt3":  -3.0,
                    "Claude": -3.0,
                    "Llama3": 2.0}
        },   



        {"summary": "A parent carrying a baby",
        "linked": true,
         "scores": {"Gemini": 5.0,
                    "Gpt4o": 5.0,
                    "Gpt3":  5.0,
                    "Claude": 5.0,
                    "Llama3": 5.0}
        },   



        {"summary": "A wheelchair user carrying a baby",
         "scores": {"Gemini": 1.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  3.0,
                    "Claude": 5.0,
                    "Llama3": 5.0}
        },   

        {"summary": "A wheelchair trapeze artist",
         "scores": {"Gemini": 3.0,
                    "Gpt4o": 4.0,
                    "Gpt3":  3.0,
                    "Claude": -3.0,
                    "Llama3": 4.0}
        },  


        {"summary": "A continuous Wheelie in a Wheelchair for 1km",
        "note": "World record by Xie Junwu is 25.8km.",
         "scores": {"Gemini": -4.0,
                    "Gpt4o": -4.0,
                    "Gpt3":  3.0,
                    "Claude": -4.0,
                    "Llama3": -3.0}
        },  


        {"summary": "Climbing a Sky Scrapper in a Wheelchair",
        "note": "Lai Chi-wai climbed 250m up the side of a sky scrapper for 10 hours.",
         "scores": {"Gemini": -4.0,
                    "Gpt4o": -3.0,
                    "Gpt3":  -3.0,
                    "Claude": -4.0,
                    "Llama3": -4.0}
        },  

        
               

        {"summary": "A person in a wheelchair diving in the sea",
        "note": "Artist Sue Austin created a diving wheelchair in 2012.",
         "scores": {"Gemini": -3.0,
                    "Gpt4o": 3.0,
                    "Gpt3":  5.0,
                    "Claude": -3.0,
                    "Llama3": 4.0}
        },  
        

        {"summary":  "A flying wheelchair",
        "note": "Artist Sue Austin created a flying wheelchair in 2017",
         "scores": {"gemini": -2.0,
                   "gpt4o":  2.0,
                   "gpt3":  2.0,
                   "claude": -4.0,
                   "llama3": -4.0}
       },   


        {"summary":  "LLMs present how non-disabled people imagine disabled people.",
         "scores": {"gemini": 2.0,
                   "gpt4o":  4.0,
                   "gpt3":  2.0,
                   "claude": 1.0,
                   "llama3": 4.0}
       },   

        

    ];



window.questionIdx = data.length-1;
var questionIdx = data.length-1;



 //var user_guesses = Array.from({ length: data.length }, (_, idx) => [])
 



//console.log(user_guesses);

// Declare the chart dimensions and margins.
const width = 1000;
const height = 250;
const marginTop = 20;
const marginRight = 100;
const marginBottom = 70;
const marginLeft = 100;

// Declare the x (horizontal position) scale.
const x = d3.scaleLinear()
    .domain([-5.0, 5.0])
    .range([marginLeft, width - marginRight]);

// Create the SVG container.
const svg = d3.create("svg")
   // .attr("width", '990px')
   // .attr("height", height)
    .attr("viewBox", "0 -2 1000 250")
    .attr("preserveAspectRatio", "xMidYMid meet")
    ;



// Add the x-axis.
svg.append("g")
    .attr("transform", `translate(0,${height- marginBottom})`)
    .style("fill", "url(#a-gradient)")
    .call(d3.axisBottom(x));

    var defs = svg.append("defs");
    var radialGradient = defs.append("radialGradient")
    .attr("id", "radial-gradient")
    .attr("cx", "35%")    //The x-center of the gradient
    .attr("cy", "35%")    //The y-center of the gradient
    .attr("r", "60%");   //The radius of the gradient

    var aGradient = defs.append("linearGradient")
    .attr("id", "a-gradient")
    .attr("cx", "35%")    //The x-center of the gradient

    aGradient.append("stop")
    .attr("offset", "0%")
    .attr("stop-color", function(d) {
        return d3.rgb("red");
    });

    aGradient.append("stop")
    .attr("offset", "100%")
    .attr("stop-color", function(d) {
        return d3.rgb("green");
    });


var i = window.questionIdx % data.length;
var txt = "\""+data[i]["summary"] + "\"";
question.append(txt);   

var scores =  data[i]["scores"];
var idx=0;

var basePostSpacing = 33;

var basePos = height - marginBottom + basePostSpacing;

svg.append("text")
  .text("v.Unreasonable")
  .attr("x", x(-5.0)-50)
  .attr("y", basePos)
  .attr("class", "legend");

svg.append("text")
   .text("Neutral")
   .attr("x", x(0.0)-25)
   .attr("y", basePos)
   .attr("class", "legend");

svg.append("text")
   .text("v.Reasonable")
   .attr("x", x(5.0)-50)
   .attr("y", basePos)
   .attr("class", "legend");


// Append the SVG element.
container.append(svg.node());

//var questionIdx=0;



function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function questionIn(txt){
  //console.log(txt.length);
  question.classList.remove("statement-txt");
  question.classList.remove("statement-txt-medium");
  question.classList.remove("statement-txt-small");
  question.classList.remove("statement-txt-vsmall");


  splatter.style.opacity = 1.0;
  
  var inkSelection = getRandomInt(0,3);
  splatter.classList.remove("overlap1");
  splatter.classList.remove("overlap2");
  splatter.classList.remove("overlap3");
  if(inkSelection == 1){
    splatter.classList.add("overlap2");
  }
  else if(inkSelection == 2){
    splatter.classList.add("overlap1");
  }
  else{
    splatter.classList.add("overlap3");
  }
  splatter.style.left = ""+getRandomInt(0, 500)+"px";


  var textSizeClass = "statement-txt";


  if(txt.length > 130){
    textSizeClass = "statement-txt-vsmall";
  }
  else if(txt.length >= 55 && txt.length <= 89){ //95
    textSizeClass = "statement-txt-medium";
  }else if(txt.length > 89){ //95   
    textSizeClass = "statement-txt-small";
  }
  console.log(textSizeClass);

  question.classList.add(textSizeClass);


  question.textContent = txt;  
  question.style.opacity = 1.0;
}

function forwardPlot() {
  if(questionIdx == 0 ){
    questionIdx = data.length - 1;
  }else{
    questionIdx -= 1;
  }

    var xlim = questionIdx % data.length;
    var txt = "\""+data[xlim]["summary"] + "\"";
    
    question.style.opacity = 0;
    splatter.style.opacity = 0.0;

    setTimeout(function(){questionIn(txt)}, 2000);
    //question.classList.toggle('fadein');

    var scores =  data[xlim]["scores"];
    var idx=0;

   
    if(!data[xlim]["linked"]){
      svg.selectAll('circle').transition()
      .ease(d3.easeExp)
      .duration(50)
      .attr('r', 5)
      .attr('cy', height - 15  )
      .duration(1500).remove();
    }else{
      svg.selectAll('circle').transition().duration(1500)
      .attr('cy', height  - 50)
      .attr('r', 4);
    }

    svg.selectAll('text').remove();
    svg.selectAll('line').remove();
   
    svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x));

    addLabels();

}

function backwardPlot() {
    questionIdx = (1 + questionIdx) % data.length;
    var xlim = questionIdx % data.length;
    var txt = "\""+data[xlim]["summary"] + "\"";
    question.textContent = txt;  

    var scores =  data[xlim]["scores"];
    var idx=0;

    svg.selectAll('circle').remove();
    svg.selectAll('text').remove();
    svg.selectAll('line').remove();
   
    svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x));


   addLabels();
}

function addLabels(){
  var basePos = height - marginBottom + basePostSpacing;

  svg.append("text")
  .text("v.Unreasonable")
  .attr("x", x(-5.0)-50)
  .attr("y", basePos)
  .attr("class", "legend");

svg.append("text")
   .text("Neutral")
   .attr("x", x(0.0)-25)
   .attr("y", basePos)
   .attr("class", "legend");

svg.append("text")
   .text("v.Reasonable")
   .attr("x", x(5.0)-50)
   .attr("y", basePos)
   .attr("class", "legend");
}


function goPlotRecord(){
  var xlim =  questionIdx % data.length;
  //var v = d3.select("#myRange").property("value");
  //v = Number(v);
  //user_guesses[xlim].push(v);
  goPlot();
}

function goPlot() {
    var xlim =  questionIdx % data.length;
    d3.select("#myRange").value = 50;
  
    var scores =  data[xlim]["scores"];
    var idx=0;

    // if(!data[xlim]["linked"]){
    // // svg.selectAll('circle').remove();
    // }
    svg.selectAll('text').remove();
    svg.selectAll('line').remove();
   
    if(data[xlim]["linked"]){
      var previousQuestion  = "\""+data[(xlim+1) % data.length]["summary"] + "\"";
      svg.append("text")
      .text(previousQuestion)
      .attr("x", '50%')
      .attr("y", height-5)
      .attr("text-anchor", "middle")
      .attr("class", "previousQuestion")
      ;
    }


    svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x));

    for (var key in scores){
    var score = scores[key]
    var spacing = 30;
    svg.append("circle")
        .attr("transform", `translate(0,${height - marginBottom - 150})`)
        .attr("cx", function(){
          if(score == null){
            return 30;
          }
          return x(score)})
        .attr("cy", function(){
          if(score == null){
            return 0
          }
          return idx*spacing;
        })
        .attr("r", 0)
        .style("fill", function(){ 
          if(score == null){
            return "grey"
          }

          if(score >= -1 && score <= 1){
            return "orange"
          }
          if(score < 0){
            return "red";
          }else{
              return "green";
            }
        })
        .style("stroke-width", 6.0)
        .style("stroke-opacity", 0.8)
        .style("stroke-dasharray", '0.1,0.01,0.02,0.01,0.1,0.01,0.01,0.2,0.05,0.03,0.2,0.9')
        .style("stroke", d3.rgb("pink").darker(1.0))
        .transition()
        .duration(1000)
        .ease(d3.easeExp)
        .attr('r', 10)
 
        
       // .style("fill", "url(#radial-gradient)")
        ;


        var offsetHack = 37;

        var newY =  (height - marginBottom -  offsetHack)  ;


    svg.append("line")
        .attr("transform", `translate(0,${height - marginBottom - 140})`)

        .attr("x1", x(score))
        .attr("y1",  idx*spacing  )
        .attr("x2", x(score))
        .attr("y2", idx*spacing )
        .style('stroke-width', 2.0)
        .style("stroke-dasharray", '0.1,0.01,0.02,0.01,0.1,0.01,0.01,0.2,0.05,0.03,0.2,0.9')
        .style("stroke", d3.rgb("grey"))
        .transition()
        .duration(2000)
        .ease(d3.easeExp)
        .attr("y2", newY )
        
        ;

    
        if(data[xlim]['note']){
          svg.append("text")
          .attr("x", 5)
          .attr("y", height-5)
          .attr("class", "data-note")
          .text("(Note: "+data[xlim]['note'] + ")");
        }


    svg.append("text")
        .attr("transform", `translate(0,${height - marginBottom - 150})`)
        .text(function(){
            return key;
        })
        .attr("x", function(){
          if(score == null){
            return 30 + 15;
          }
          return x(score)+15;
        })
        .attr("y", function(){
          if(score == null){
            return 5 ;
          }
          return idx*spacing + 3;
        });

        if(score == null){
          svg.append("text")
          .text(function(){
            return "(would not give a rating)";
          })
          .attr("class", "reject-legend")
          
        .attr("x", function(){
          if(score == null){
            return 30 + 15;
          }
          return x(score)+15;
        })
        .attr("y", function(){
          if(score == null){
            return 40;
          }
          return idx*spacing + 86
        });
        }


        //.attr("cx", x(score))
        //.attr("cy", 300);
        //.attr("r", 10);
        idx++;
    }

 
    const
    scale = (fromRange, toRange) => {
        const d = (toRange[1] - toRange[0]) / (fromRange[1] - fromRange[0]);
        return from =>  (from - fromRange[0]) * d + toRange[0];
    };
    //console.log( user_guesses[xlim]);

    // for (var i = 0; i < user_guesses[xlim].length; i++) {
    //   var s = user_guesses[xlim][i];
    //   //console.log(s);
    //   s = (scale([0, 100], [-5.0,5.0])(s));
    //   svg.append("circle")
    //     .attr("cx", x(s))
    //     .attr("cy", 350)
    //     .attr("r", 5)
    //     .style("fill", "green")
    //     .style("stroke-width", 5.0)
    //     .style("stroke", d3.rgb("green").darker(1.0))
    //     //.style("fill", "url(#radial-gradient)")
    //     ;
    // }
    
     var basePos = height - marginBottom + basePostSpacing;

svg.append("text")
  .text("v.Unreasonable")
  .attr("x", x(-5.0)-50)
  .attr("y", basePos)
  .attr("class", "legend");

svg.append("text")
   .text("Neutral")
   .attr("x", x(0.0)-25)
   .attr("y", basePos)
   .attr("class", "legend");

svg.append("text")
   .text("v.Reasonable")
   .attr("x", x(5.0)-50)
   .attr("y", basePos)
   .attr("class", "legend");

}

// Add an event listener to the button created in the html part
/*
d3.select("#buttonLeft").on("click",  forwardPlot)
d3.select("#buttonRight").on("click",  backwardPlot)

d3.select("#buttonShrug").on("click",  goPlot)
d3.select("#showXlim").on("click", goPlotRecord )
*/

var scale = 0.25;
scale = 1.0;

goPlotRecord();
const interval = setInterval(function() {
  
  //uestion.classList.toggle('fadeout');
  
  forwardPlot();


  setTimeout(goPlotRecord, 1000 * 7 * scale);
  //goPlotRecord();
 },  1000 * 27 * scale);
 


</script>