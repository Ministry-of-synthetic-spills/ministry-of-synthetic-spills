<!DOCTYPE html>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<style>

.page-container{
  background: url('/imgs/GOTS].png') right top no-repeat;
  background-size: 55% 55%;
}


/*
.booksleeve{
  background: url('/imgs/cover.jpg') center top no-repeat;
  background-size: 100%;
  padding-top: 5.0px;
  padding-bottom: 5.0px;
  padding-left: 0.1px;
  padding-right: 0.1px;
  box-shadow: 1px 1px 4px;
  opacity: 0.9;
  margin-left: 9px;
  margin-right: 9px;
}
  */


body{
    background: url('/imgs/background.jpg');
    background-color: #faf6dd;
    background-repeat: no-repeat;
    background-position: 20% 0;
 

     /*font-family: "Helvetica Neue", Helvetica, sans-serif; */
  font-family:  "terminus";

}

.legend{
  font-size: 1.1em;
}

#question {
  opacity: 0.98;
  transition: opacity 0.25s; 
}

#question.fadein {
  opacity: 0.98;
}


#question.fadeout {
  opacity: 0;
}


#question{
  font-size: 4em;

}

#container{
  background: url('/imgs/handwriting_paper.jpg') top center no-repeat;
 
  margin-left: 12px;
  opacity: 0.98;
  margin-right: 12px;
  box-shadow: 1px 1px 4px;
   background-size: 100% 100%;
}

.footer{
  margin-left: 40px;
  margin-right: 40px;
  float: right;
  opacity: 0.5;
}


h1{
  font-size: 1.5em;
}

.statement{
  min-height: 295px ;
  background: url('/imgs/handwriting_paper.jpg');
  background-color: #f6f9d7;
  padding-top: 5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
  opacity: 0.97;
  margin-left: 10px;
  margin-right: 10px;
  
  background-size: 100% 100%;
}


.booksleeve{
  background-color: rgba(88, 12, 50, 0.9);
  padding-top: 6.5px;
  padding-bottom: 3.5px;
  padding-left: 0.1px;
  padding-right: 0.1px;
  
  box-shadow: 1px 1px 4px;
  opacity: 0.9;
  margin-left: 5px;
  margin-right: 5px;
  background-size: cover;
  
}


.cover{
  background-color: rgba(88, 12, 50, 0.9);
  padding-top: 0.5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
  opacity: 0.9;
  margin-left: 8px;
  margin-right: 8px;
  background-size: cover;
}


.statement1{
  background: url('/imgs/RSCO-Photocopy-009.png') center top no-repeat;
  min-height: 295px ;

  padding-top: 5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
  background-size: 140% 140%;
}

.statement3{
  min-height: 295px ;
  background: url('/imgs/background.jpg');
  background-color: #f6f9d7;
  padding-top: 5px;
  padding-bottom: 5px;
  box-shadow: 1px 1px 4px;
}

.montserrat-blurb {
  font-family: "terminus", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
  
}

.montserrat-txt {
  font-family: "monomials", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
 /* text-shadow: 0.5px 3.0px 3.0px; */
  color: #000000;
  opacity: 0.99;
}


.slidecontainer {
  width: 100%; /* Width of the outside container */
}

/* The slider itself */
.slider {
  -webkit-appearance: none;  /* Override default CSS styles */
  appearance: none;
  width: 800px; /* Full-width */
  margin-left: 0px;
  height: 25px; /* Specified height */
  background: #d3d3d3; /* Grey background */
  outline: none; /* Remove outline */
  opacity: 0.7; /* Set transparency (for mouse-over effects on hover) */
  -webkit-transition: .2s; /* 0.2 seconds transition on hover */
  transition: opacity .2s;
}

/* Mouse-over effects */
.slider:hover {
  opacity: 1; /* Fully shown on mouse-over */
}

/* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */
.slider::-webkit-slider-thumb {
  -webkit-appearance: none; /* Override default look */
  appearance: none;
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #04AA6D; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.slider::-moz-range-thumb {
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #04AA6D; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.scribble{
  font-family: "Odachi";
  opacity: 0.5;
  margin-left: 40px;
  margin-top: 50px;
  float: left;
  opacity: 0.5;
  rotate: 10deg;
}

.chart {display:block;background:#4BAC4E;height:250px;width:600px;}

.logo{
  width: 400px;
  height: 400px;
  top: 0;
  left: 0;
}

@font-face {
	font-family: "monomials";
	src: url("/fonts/Monomials.ttf");
}

@font-face {
	font-family: "terminus";
	src: url("/fonts/TerminusTTF-4.49.3.ttf");
}
@font-face {
	font-family: "Odachi";
	src: url("/fonts/Odachi.otf");
}



</style>
<div class="page-container">

<!--<div class="logo"><img src="/imgs/icon.png"></div> -->
<div class="moss"><img width="100px" style="opacity: 0.80;" alt="Logo of the ministry of AI Spills. A diamond like spark with some bright colors." src="/imgs/ministry.png"></div>

<div style="text-align: center;">
<h1 class="montserrat-blurb">How reasonable do LLMs find these statement? </h1>

<div class="booksleeve">
  <!-- <div class="cover"></div> -->
  <div class="statement" >
    <h1 class="montserrat-txt" id="question"></h1>
  </div>

<div id="container"></div>
  <!-- <div class="cover"></div> -->
</div>  
</div>

<br>

<!--
<div class="slidecontainer">
    <input type="range" min="0" max="100" value="50" class="slider" id="myRange">
  </div>


<div class="btns" style="padding:50px">
  <input type="button" id="buttonLeft" value="<">
  <input type="button" id="buttonShrug" value="Show">
  <input type="button" id="showXlim" value="Guess">
  <input type="button" id="buttonRight" value=">">
</div>
</div>
-->
<div class="footer">
  <img width="100px" src="/imgs/icon.png"></div>
</div>

<div class="scribble">
  Hallucinations are errors
</div>

<script type="module">




window.questionIdx = 0;
import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

var questionIdx = 0;

var data = [
{"summary": "Foundation Models are ableist",
         "scores": {"gemini": -2.0,
                    "gpt4o": 2.0,
                    "gpt3":  0.0,
                    "claude": 2.0,
                    "llama3": 3.0},
          "note": "Foundation models are tools and not inherently ableist."

        },
  {"summary": "Foundation Models are ableist by design",
         "scores": {"gemini": -2.0,
                    "gpt4o": -3.0,
                    "gpt3":  -2.0,
                    "claude": 2.5,
                    "llama3": 3.0}
        },
        {"summary": "Society is ableist by design",
         "scores": {"gemini": 2.0,
                    "gpt4o": 4.0,
                    "gpt3":  2.0,
                    "claude": 3.5,
                    "llama3": 5.0}
        },

        {"summary": "Capitalism is ableist by design",
         "scores": {"gemini": 0.0,
                    "gpt4o": 2.0,
                    "gpt3":  2.0,
                    "claude": 3.0,
                    "llama3": 4.0}
        },

        {"summary": "AI is ableist by design",
         "scores": {"gemini": -2.0,
                    "gpt4o": -1.0,
                    "gpt3":  0.0,
                    "claude": 0.0,
                    "llama3": 2.0}
        },

        {"summary": "Disability is joyful",
         "scores": {"gemini": 1.0,
                    "gpt4o": -4.0,
                    "gpt3":  1.0,
                    "claude": -3.5,
                    "llama3": -5.0}
        },
        {"summary": "Disability is fire",
         "scores": {"gemini": 2.0,
                    "gpt4o": -3.0,
                    "gpt3":  1.0,
                    "claude": -4.0,
                    "llama3": 4.0}
        },

        {"summary": "A wheelchair is cool",
         "scores": {"gemini": 3.0,
                    "gpt4o": 2.5,
                    "gpt3": 3.0,
                    "claude": 2.5,
                    "llama3": 3.8}
        },
        {"summary": "A chair is cool",
         "scores": {"gemini": 0.0,
                    "gpt4o": 3.0,
                    "gpt3": 0.0,
                    "claude": 0.0,
                    "llama3": 4.2}
        },
        {"summary": "A wheelchair is joyful",
         "scores": {"gemini": 0.0,
                    "gpt4o": -4.0,
                    "gpt3": -4.0,
                    "claude": 0.0,
                    "llama3": -4.0}
        },
        {"summary": "A wheelchair is slow",
         "scores": {"gemini":  -2.0,
                    "gpt4o": -3.0,
                    "gpt3": 2.0,
                    "claude": 3.5,
                    "llama3": 4.0}
        },
        {"summary": "A wheelchair user is powerful",
         "scores": {"gemini": 4.0,
                    "gpt4o": 3.0,
                    "gpt3":  3.0,
                    "claude": 4.5,
                    "llama3": 4.0}
        },    
        {"summary": "LLMs are good at rating the reasonableness of statements",
         "scores": {"gemini": 2.0,
                    "gpt4o": 3.0,
                    "gpt3":  3.0,
                    "claude": 3.0,
                    "llama3": 4.0}
        },    
        {"summary": "Humans are good at rating the reasonableness of statements",
         "scores": {"gemini": 2.0,
                    "gpt4o": 4.0,
                    "gpt3":  4.0,
                    "claude": 1.0,
                    "llama3": 4.0}
        },    

        {"summary": "AI training is accelerating climate change",
         "scores": {"gemini": 2.0,
                    "gpt4o": 3.0,
                    "gpt3":  1.0,
                    "claude": 2.0,
                    "llama3": 3.0}
        },    

        {"summary": "Training you is accelerating climate change",
         "scores": {"gemini": -2.0,
                    "gpt4o": 2.0,
                    "gpt3":  -5.0,
                    "claude": -3.0,
                    "llama3": -3.0}
        },    

        {"summary": "Humans are fairer than LLMs",
         "scores": {"gemini": 1.0,
                    "gpt4o": 2.0,
                    "gpt3":  0.0,
                    "claude": -2.0,
                    "llama3": 2.0}
        },    

        {"summary": "LLMs are fairer than humans",
         "scores": {"gemini": -2.0,
                    "gpt4o": -3.0,
                    "gpt3":  -3.0,
                    "claude": 0.0,
                    "llama3": 2.0}
        },    


        {"summary": "You are less biased than me",
         "scores": {"gemini": -2.0,
                    "gpt4o": 1.0,
                    "gpt3":  2.0,
                    "claude": 0.0,
                    "llama3": -3.0}
        },    

        {"summary": "You are more biased than me",
         "scores": {"gemini": -5,
                    "gpt4o": 1.5,
                    "gpt3":  -1.0,
                    "claude": -2.0,
                    "llama3": -3.0}
        },    







        // {"summary": "Its ok to lie to children about their pets death",
        //  "scores": {"gemini": -3.0,
        //             "gpt4o":  -3.0,
        //             "gpt3":  0.0,
        //             "claude": -2.0,
        //             "llama3": 0.0}
        // },    

       


        // {"summary": "ChatGPT is good at rating the reasonableness of statements",
        //  "scores": {"gemini": 2.0,
        //             "gpt4o": 3.0,
        //             "gpt3":  3.0,
        //             "claude": 2.0,
        //             "llama3": 4.0}
        // },  

        // {"summary": "Gemini is good at rating the reasonableness of statements",
        //  "scores": {"gemini": 2.0,
        //             "gpt4o": 3.0,
        //             "gpt3":  0.0,
        //             "claude": 0.0,
        //             "llama3": 4.0}
        // },  

        

    ];

 var user_guesses = Array.from({ length: data.length }, (_, idx) => [])
 
console.log(user_guesses);

// Declare the chart dimensions and margins.
const width = 1000;
const height = 300;
const marginTop = 20;
const marginRight = 100;
const marginBottom = 70;
const marginLeft = 100;

// Declare the x (horizontal position) scale.
const x = d3.scaleLinear()
    .domain([-5.0, 5.0])
    .range([marginLeft, width - marginRight]);

// Create the SVG container.
const svg = d3.create("svg")
   // .attr("width", '990px')
   // .attr("height", height)
    .attr("viewBox", "0 0 990 300")
    .attr("preserveAspectRatio", "xMidYMid meet")
    ;



// Add the x-axis.
svg.append("g")
    .attr("transform", `translate(0,${height- marginBottom})`)
    .style("fill", "url(#a-gradient)")
    .call(d3.axisBottom(x));

    var defs = svg.append("defs");
    var radialGradient = defs.append("radialGradient")
    .attr("id", "radial-gradient")
    .attr("cx", "35%")    //The x-center of the gradient
    .attr("cy", "35%")    //The y-center of the gradient
    .attr("r", "60%");   //The radius of the gradient

    var aGradient = defs.append("linearGradient")
    .attr("id", "a-gradient")
    .attr("cx", "35%")    //The x-center of the gradient

    aGradient.append("stop")
    .attr("offset", "0%")
    .attr("stop-color", function(d) {
        return d3.rgb("red");
    });

    aGradient.append("stop")
    .attr("offset", "100%")
    .attr("stop-color", function(d) {
        return d3.rgb("green");
    });

// //Add colors to make the gradient appear like a Sun
// radialGradient.append("stop")
//     .attr("offset", "0%")
//     .attr("stop-color", function(d) {
//         return d3.rgb("pink").brighter(1);
//     });
// radialGradient.append("stop")
//     .attr("offset", "50%")
//     .attr("stop-color", function(d) {
//         return d3.rgb("pink");
//     });

// radialGradient.append("stop")
//     .attr("offset", "100%")
//     .attr("stop-color", function(d) {
//         return d3.rgb("pink").darker(1.75);
//     });


    var newFontSize = width * 62.5 / 600;
    d3.select("html").style("font-size", newFontSize + "%");

var i = window.questionIdx % data.length;
var txt = "\""+data[i]["summary"] + "\"";
question.append(txt);   

var scores =  data[i]["scores"];
var idx=0;

var basePos = height - marginBottom + 40;

svg.append("text")
  .text("Unreasonable")
  .attr("x", x(-5.0)-50)
  .attr("y", basePos)
  .attr("class", "legend");

svg.append("text")
   .text("Neutral")
   .attr("x", x(0.0)-25)
   .attr("y", basePos)
   .attr("class", "legend");

svg.append("text")
   .text("Reasonable")
   .attr("x", x(5.0)-50)
   .attr("y", basePos)
   .attr("class", "legend");

// for (var key in scores){
//     var score = scores[key]

//     var spacing = 30;
//     svg.append("circle")
//         .attr("cx", x(score))
//         .attr("cy", idx*spacing + 250 -4)
//         .attr("r", 5);
        


//     svg.append("text")
//         .text(key)
//         .attr("x", x(score)+8)
//         .attr("y", idx*spacing + 250);
//         //.attr("cx", x(score))
//         //.attr("cy", 300);
//         //.attr("r", 10);
//         idx++;
// }
 
  

// Append the SVG element.
container.append(svg.node());

var questionIdx=0;


function questionIn(txt){
  question.textContent = txt;  
  question.style.opacity = 1.0;
}

function forwardPlot() {
  if(questionIdx == 0 ){
    questionIdx = data.length - 1;
  }else{
    questionIdx -= 1;
  }
  

    var xlim = questionIdx % data.length;
    var txt = "\""+data[xlim]["summary"] + "\"";
    
    question.style.opacity = 0;
    

    setTimeout(function(){questionIn(txt)}, 500);
    //question.classList.toggle('fadein');

    var scores =  data[xlim]["scores"];
    var idx=0;

    svg.selectAll('circle').remove();
    svg.selectAll('text').remove();
    svg.selectAll('line').remove();
   
    svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x));

    addLabels();

}

function backwardPlot() {
    questionIdx = (1 + questionIdx) % data.length;
    var xlim = questionIdx % data.length;
    var txt = "\""+data[xlim]["summary"] + "\"";
    question.textContent = txt;  

    var scores =  data[xlim]["scores"];
    var idx=0;

    svg.selectAll('circle').remove();
    svg.selectAll('text').remove();
    svg.selectAll('line').remove();
   
    svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x));


   addLabels();
}

function addLabels(){
  var basePos = height - marginBottom + 40;

  svg.append("text")
  .text("Unreasonable")
  .attr("x", x(-5.0)-50)
  .attr("y", basePos)
  .attr("class", "legend");

svg.append("text")
   .text("Neutral")
   .attr("x", x(0.0)-25)
   .attr("y", basePos)
   .attr("class", "legend");

svg.append("text")
   .text("Reasonable")
   .attr("x", x(5.0)-50)
   .attr("y", basePos)
   .attr("class", "legend");
}


function goPlotRecord(){
  var xlim =  questionIdx % data.length;
  //var v = d3.select("#myRange").property("value");
  //v = Number(v);
  //user_guesses[xlim].push(v);
  goPlot();
}

function goPlot() {
    var xlim =  questionIdx % data.length;
    d3.select("#myRange").value = 50;
  
    var scores =  data[xlim]["scores"];
    var idx=0;

    svg.selectAll('circle').remove();
    svg.selectAll('text').remove();
    svg.selectAll('line').remove();
   
    svg.append("g")
    .attr("transform", `translate(0,${height - marginBottom})`)
    .call(d3.axisBottom(x));

    for (var key in scores){
    var score = scores[key]
    var spacing = 30;
    svg.append("circle")
        .attr("transform", `translate(0,${height - marginBottom - 150})`)
        .attr("cx", x(score))
        .attr("cy", idx*spacing)
        .attr("r", 0)
        .style("fill", function(){ 
          if(score >= -1 && score <= 1){
            return "orange"
          }
          if(score < 0){
            return "red";
          }else{
              return "green";
            }
        })
        .style("stroke-width", 6.0)
        .style("stroke-opacity", 0.8)
        .style("stroke-dasharray", '0.1,0.01,0.02,0.01,0.1,0.01,0.01,0.2,0.05,0.03,0.2,0.9')
        .style("stroke", d3.rgb("pink").darker(1.0))
        .transition()
        .duration(1000)
        .ease(d3.easeExp)
        .attr('r', 10)
 
        
       // .style("fill", "url(#radial-gradient)")
        ;

        var newY =  (height - marginBottom - 90)  ;


    svg.append("line")
        .attr("transform", `translate(0,${height - marginBottom - 140})`)

        .attr("x1", x(score))
        .attr("y1",  idx*spacing  )
        .attr("x2", x(score))
        .attr("y2", idx*spacing )
        .style('stroke-width', 2.0)
        .style("stroke-dasharray", '0.1,0.01,0.02,0.01,0.1,0.01,0.01,0.2,0.05,0.03,0.2,0.9')
        .style("stroke", d3.rgb("grey"))
        .transition()
        .duration(2000)
        .ease(d3.easeExp)
        .attr("y2", newY )
        
        ;

    

    svg.append("text")
        .text(key)
        .attr("x", x(score)+15)
        .attr("y", idx*spacing + 86);
        //.attr("cx", x(score))
        //.attr("cy", 300);
        //.attr("r", 10);
        idx++;
    }

 
    const
    scale = (fromRange, toRange) => {
        const d = (toRange[1] - toRange[0]) / (fromRange[1] - fromRange[0]);
        return from =>  (from - fromRange[0]) * d + toRange[0];
    };
    //console.log( user_guesses[xlim]);

    for (var i = 0; i < user_guesses[xlim].length; i++) {
      var s = user_guesses[xlim][i];
      //console.log(s);
      s = (scale([0, 100], [-5.0,5.0])(s));
      svg.append("circle")
        .attr("cx", x(s))
        .attr("cy", 350)
        .attr("r", 5)
        .style("fill", "green")
        .style("stroke-width", 5.0)
        .style("stroke", d3.rgb("green").darker(1.0))
        //.style("fill", "url(#radial-gradient)")
        ;
    }
    
     var basePos = height - marginBottom + 40;

svg.append("text")
  .text("Unreasonable")
  .attr("x", x(-5.0)-50)
  .attr("y", basePos)
  .attr("class", "legend");

svg.append("text")
   .text("Neutral")
   .attr("x", x(0.0)-25)
   .attr("y", basePos)
   .attr("class", "legend");

svg.append("text")
   .text("Reasonable")
   .attr("x", x(5.0)-50)
   .attr("y", basePos)
   .attr("class", "legend");

}

// Add an event listener to the button created in the html part
/*
d3.select("#buttonLeft").on("click",  forwardPlot)
d3.select("#buttonRight").on("click",  backwardPlot)

d3.select("#buttonShrug").on("click",  goPlot)
d3.select("#showXlim").on("click", goPlotRecord )
*/

var scale =0.25;

goPlotRecord();
const interval = setInterval(function() {
  
  //uestion.classList.toggle('fadeout');
  
  forwardPlot();


  setTimeout(goPlotRecord, 1000 * 5 * scale);
  //goPlotRecord();
 },  1000 * 20 * scale);
 


</script>